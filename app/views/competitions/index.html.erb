<div class="current-competition border-dotted rounded border-secondary d-flex align-items-center flex-column p-3">

  <% if @current_competition %>
    <h2 class="d-inline-block w-100 text-center">Current competition <i class="ri-trophy-fill text-secondary d-inline-block" style="transform: rotate(10deg)"></i></h2>
    <div class="scores d-flex align-items-center justify-content-evenly w-100">
      <% @family.users.each do |user| %>
        <div class="d-flex align-items-center flex-column text-center" style="width: 4rem">
          <p><strong><%= user.first_name %></strong></p>

          <%= render "shared/picture", user: user, size: "3rem", kid_or_parent: "parent" %>

          <p class="fs-1">
            <strong data-controller="counter" data-counter-target="counter">
              <%= user.scores.where(competition: @current_competition)[0].score %>
            </strong>
          </p>
        </div>
        <% unless user == @family.users.last %>
          <%= image_tag "crown.svg", alt: "crown image", style: "width: 50px; transform: rotate(20deg);" %>
        <% end %>
      <% end %>
    </div>

    <p class="mt-3"><strong><%= (@current_competition.end_date - Date.current).to_i %> days remaining</strong></p>

    <h3 class="mt-5">Reward:</h3>
    <p><%= @current_competition.reward %></p>
  <% else %>
    <p class="fst-italic">No current competition</p>
    <%= link_to "New competition", new_competition_path, class: "btn btn-secondary fw-bold" %>
  <% end %>
</div>

<div class="previous-competitions mt-4">
  <h2>Previous competitions</h2>

  <% unless @competitions.empty? %>
    <div data-controller="swiper" class="w-100" style="height: 230px">
      <swiper-container class="mySwiper h-100"
                        pagination="true"
                        pagination-dynamic-bullets="true"
                        effect="cards"
                        cards-effect-per-slide-offset="1"
                        cards-effect-slide-shadows="false">

        <% @competitions.each do |competition| %>

          <swiper-slide class="p-1">
            <%= render 'competitions/past_competition', competition: competition %>
          </swiper-slide>

        <% end %>
      </swiper-container>
    </div>
  <% else %>
    <p class="fst-italic text-ligth">No previous competition</p>
  <% end %>
</div>


<% if @current_competition %>
  <div class="d-flex justify-content-center mt-5 mb-4">
    <%= link_to "Delete current competition", competition_path(@current_competition), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: "btn btn-outline-danger" %>
  </div>
<% end %>
